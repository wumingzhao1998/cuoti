# 快速检查清单

## ✅ 已完成的更新

### 字段映射修复
- ✅ "不会/做错"（单选）→ `fields["不会/做错"]`
- ✅ "不会/做错的原因"（文本）→ `fields["不会/做错的原因"]`
- ✅ "记忆口诀" → `fields["记忆口诀"]`
- ✅ "学科" → `fields["学科"]`（替代了"科目"和"年级"）
- ✅ "创建时间" → `fields["创建时间"]`（替代了"录入时间"）
- ✅ "是否母题" → `fields["是否母题"]`（单选：是/否）

### 代码更新
- ✅ `src/feishu/models.py` - 数据模型已更新
- ✅ `src/feishu/client.py` - 字段映射已修复
- ✅ `main.py` - 记录创建逻辑已更新
- ✅ 文档已更新（FIELD_MAPPING.md, UPDATE_SUMMARY.md）

## 🧪 测试建议

### 1. 检查字段映射
确认飞书表格中的字段名与代码中的字段名完全一致：
- 创建时间
- 学科
- 错题原题
- 去手写
- 知识点
- 不会/做错
- 不会/做错的原因
- 引导问题
- 思考过程
- 解题思路
- 解题清单
- 记忆口诀
- 是否母题
- 掌握程度
- 最后复习时间
- 复习次数

### 2. 测试创建记录
```bash
python main.py path/to/question.jpg 不会
```

### 3. 验证保存结果
在飞书表格中检查：
- 所有字段是否正确保存
- 字段值是否符合预期
- 附件（图片）是否正确上传

## 📝 字段值说明

### 单选字段的选项值
- **学科**：数学 / 语文 / 英语
- **不会/做错**：不会 / 做错
- **是否母题**：是 / 否
- **掌握程度**：未掌握 / 掌握中 / 已掌握

### 日期时间字段
- 使用时间戳（毫秒）格式：`int(datetime.timestamp() * 1000)`

### 附件字段
- 需要先上传文件获取file_token
- 格式：`[{"file_token": "xxx"}]`

## ⚠️ 常见问题

### 1. 字段名不匹配
如果飞书表格中的字段名与代码不一致，修改 `src/feishu/client.py` 中的字段映射。

### 2. 单选选项值不匹配
确保代码中使用的选项值与飞书表格中定义的选项值完全一致（包括空格、标点等）。

### 3. 附件上传失败
检查：
- 文件路径是否正确
- 文件是否存在
- 飞书应用是否有上传文件的权限

## 🚀 下一步

1. 运行测试验证功能
2. 处理一张实际错题图片
3. 检查飞书表格中的保存结果
4. 根据实际情况调整字段映射

